-- データベースの作成（psqlなどのコマンドラインツールを使用して接続）
CREATE DATABASE HR;

-- データベース接続後に以下のスクリプトを実行

-- スキーマの作成
CREATE SCHEMA HR;

-- テーブルの作成
CREATE TABLE HR.REGIONS (
    REGION_ID     INT PRIMARY KEY,
    REGION_NAME   VARCHAR(25) NOT NULL
);

CREATE TABLE HR.COUNTRIES (
    COUNTRY_ID    CHAR(2) PRIMARY KEY,
    COUNTRY_NAME  VARCHAR(40),
    REGION_ID     INT,
    CONSTRAINT COUNTRY_REG_FK FOREIGN KEY (REGION_ID) REFERENCES HR.REGIONS(REGION_ID)
);

CREATE TABLE HR.LOCATIONS (
    LOCATION_ID   INT PRIMARY KEY,
    STREET_ADDRESS VARCHAR(40),
    POSTAL_CODE   VARCHAR(12),
    CITY          VARCHAR(30) NOT NULL,
    STATE_PROVINCE VARCHAR(25),
    COUNTRY_ID    CHAR(2),
    CONSTRAINT LOC_C_ID_FK FOREIGN KEY (COUNTRY_ID) REFERENCES HR.COUNTRIES(COUNTRY_ID)
);

CREATE TABLE HR.DEPARTMENTS (
    DEPARTMENT_ID   INT PRIMARY KEY,
    DEPARTMENT_NAME VARCHAR(30) NOT NULL,
    MANAGER_ID      INT,
    LOCATION_ID     INT,
    CONSTRAINT DEPT_LOC_FK FOREIGN KEY (LOCATION_ID) REFERENCES HR.LOCATIONS(LOCATION_ID)
);

CREATE TABLE HR.JOBS (
    JOB_ID        VARCHAR(10) PRIMARY KEY,
    JOB_TITLE     VARCHAR(35) NOT NULL,
    MIN_SALARY    BIGINT CHECK (MIN_SALARY > 0),
    MAX_SALARY    BIGINT CHECK (MAX_SALARY > 0)
);

CREATE TABLE HR.EMPLOYEES (
    EMPLOYEE_ID   INT PRIMARY KEY,
    FIRST_NAME    VARCHAR(20),
    LAST_NAME     VARCHAR(25) NOT NULL,
    EMAIL         VARCHAR(25) NOT NULL UNIQUE,
    PHONE_NUMBER  VARCHAR(20),
    HIRE_DATE     DATE NOT NULL,
    JOB_ID        VARCHAR(10) NOT NULL,
    SALARY        INT CHECK (SALARY > 0),
    COMMISSION_PCT INT,
    MANAGER_ID    INT,
    DEPARTMENT_ID INT,
    CONSTRAINT EMP_JOB_FK FOREIGN KEY (JOB_ID) REFERENCES HR.JOBS(JOB_ID),
    CONSTRAINT EMP_DEPT_FK FOREIGN KEY (DEPARTMENT_ID) REFERENCES HR.DEPARTMENTS(DEPARTMENT_ID),
    CONSTRAINT EMP_MGR_FK FOREIGN KEY (MANAGER_ID) REFERENCES HR.EMPLOYEES(EMPLOYEE_ID)
);

CREATE TABLE HR.JOB_HISTORY (
    EMPLOYEE_ID  INT,
    START_DATE   DATE,
    END_DATE     DATE,
    JOB_ID       VARCHAR(10),
    DEPARTMENT_ID INT,
    PRIMARY KEY (EMPLOYEE_ID, START_DATE),
    CONSTRAINT JHIST_JOB_FK FOREIGN KEY (JOB_ID) REFERENCES HR.JOBS(JOB_ID),
    CONSTRAINT JHIST_DEPT_FK FOREIGN KEY (DEPARTMENT_ID) REFERENCES HR.DEPARTMENTS(DEPARTMENT_ID)
);

-- データの挿入
INSERT INTO HR.REGIONS VALUES (1, 'Europe');
INSERT INTO HR.REGIONS VALUES (2, 'Americas');
INSERT INTO HR.REGIONS VALUES (3, 'Asia');
INSERT INTO HR.REGIONS VALUES (4, 'Middle East and Africa');

INSERT INTO HR.COUNTRIES VALUES ('IT', 'Italy', 1);
INSERT INTO HR.COUNTRIES VALUES ('JP', 'Japan', 3);
INSERT INTO HR.COUNTRIES VALUES ('US', 'United States of America', 2);
INSERT INTO HR.COUNTRIES VALUES ('CA', 'Canada', 2);
INSERT INTO HR.COUNTRIES VALUES ('CN', 'China', 3);
INSERT INTO HR.COUNTRIES VALUES ('IN', 'India', 3);
INSERT INTO HR.COUNTRIES VALUES ('AU', 'Australia', 3);
INSERT INTO HR.COUNTRIES VALUES ('ZW', 'Zimbabwe', 4);
INSERT INTO HR.COUNTRIES VALUES ('SG', 'Singapore', 3);
INSERT INTO HR.COUNTRIES VALUES ('UK', 'United Kingdom', 1);
INSERT INTO HR.COUNTRIES VALUES ('FR', 'France', 1);
INSERT INTO HR.COUNTRIES VALUES ('DE', 'Germany', 1);
INSERT INTO HR.COUNTRIES VALUES ('ZM', 'Zambia', 4);
INSERT INTO HR.COUNTRIES VALUES ('EG', 'Egypt', 4);
INSERT INTO HR.COUNTRIES VALUES ('BR', 'Brazil', 2);
INSERT INTO HR.COUNTRIES VALUES ('CH', 'Switzerland', 1);
INSERT INTO HR.COUNTRIES VALUES ('NL', 'Netherlands', 1);
INSERT INTO HR.COUNTRIES VALUES ('MX', 'Mexico', 2);
INSERT INTO HR.COUNTRIES VALUES ('KW', 'Kuwait', 4);
INSERT INTO HR.COUNTRIES VALUES ('IL', 'Israel', 4);
INSERT INTO HR.COUNTRIES VALUES ('DK', 'Denmark', 1);
INSERT INTO HR.COUNTRIES VALUES ('ML', 'Malaysia', 3);
INSERT INTO HR.COUNTRIES VALUES ('NG', 'Nigeria', 4);
INSERT INTO HR.COUNTRIES VALUES ('AR', 'Argentina', 2);
INSERT INTO HR.COUNTRIES VALUES ('BE', 'Belgium', 1);

INSERT INTO HR.LOCATIONS VALUES (1000, '1297 Via Cola di Rie', '00989', 'Roma', NULL, 'IT');
INSERT INTO HR.LOCATIONS VALUES (1100, '93091 Calle della Testa', '10934', 'Venice', NULL, 'IT');
INSERT INTO HR.LOCATIONS VALUES (1200, '2017 Shinjuku-ku', '1689', 'Tokyo', 'Tokyo Prefecture', 'JP');
INSERT INTO HR.LOCATIONS VALUES (1300, '9450 Kamiya-cho', '6823', 'Hiroshima', NULL, 'JP');
INSERT INTO HR.LOCATIONS VALUES (1400, '2014 Jabberwocky Rd', '26192', 'Southlake', 'Texas', 'US');
INSERT INTO HR.LOCATIONS VALUES (1500, '2011 Interiors Blvd', '99236', 'South San Francisco', 'California', 'US');
INSERT INTO HR.LOCATIONS VALUES (1600, '2007 Zagora St', '50090', 'South Brunswick', 'New Jersey', 'US');
INSERT INTO HR.LOCATIONS VALUES (1700, '2004 Charade Rd', '98199', 'Seattle', 'Washington', 'US');
INSERT INTO HR.LOCATIONS VALUES (1800, '147 Spadina Ave', 'M5V 2L7', 'Toronto', 'Ontario', 'CA');
INSERT INTO HR.LOCATIONS VALUES (1900, '6092 Boxwood St', 'YSW 9T2', 'Whitehorse', 'Yukon', 'CA');
INSERT INTO HR.LOCATIONS VALUES (2000, '40-5-12 Laogianggen', '190518', 'Beijing', NULL, 'CN');
INSERT INTO HR.LOCATIONS VALUES (2100, '1298 Vileparle (E)', '490231', 'Bombay', 'Maharashtra', 'IN');
INSERT INTO HR.LOCATIONS VALUES (2200, '12-98 Victoria Street', '2901', 'Sydney', 'New South Wales', 'AU');
INSERT INTO HR.LOCATIONS VALUES (2300, '198 Clementi North', '540198', 'Singapore', NULL, 'SG');
INSERT INTO HR.LOCATIONS VALUES (2400, '8204 Arthur St', NULL, 'London', NULL, 'UK');
INSERT INTO HR.LOCATIONS VALUES (2500, 'Magdalen Centre, The Oxford Science Park', 'OX9 9ZB', 'Oxford', 'Oxford', 'UK');
INSERT INTO HR.LOCATIONS VALUES (2600, '9702 Chester Road', '09629850293', 'Stretford', 'Manchester', 'UK');
INSERT INTO HR.LOCATIONS VALUES (2700, 'Schwanthalerstr. 7031', '80925', 'Munich', 'Bavaria', 'DE');
INSERT INTO HR.LOCATIONS VALUES (2800, 'Rua Frei Caneca 1360 ', '01307-002', 'Sao Paulo', 'Sao Paulo', 'BR');
INSERT INTO HR.LOCATIONS VALUES (2900, '20 Rue des Corps-Saints', '1730', 'Geneva', 'Geneve', 'CH');
INSERT INTO HR.LOCATIONS VALUES (3000, 'Murtenstrasse 921', '3095', 'Bern', 'BE', 'CH');
INSERT INTO HR.LOCATIONS VALUES (3100, 'Pieter Breughelstraat 837', '3029SK', 'Utrecht', 'Utrecht', 'NL');
INSERT INTO HR.LOCATIONS VALUES (3200, 'Mariano Escobedo 9991', '11932', 'Mexico City', 'Distrito Federal,' , 'MX');

-- テーブルの残りのデータと制約の挿入
-- 以下のパターンで残りのデータと制約を追加できます。

-- 例えばDEPARTMENTSテーブル
INSERT INTO HR.DEPARTMENTS VALUES (10, 'Administration', 200, 1700);

-- 例えばJOBSテーブル
INSERT INTO HR.JOBS VALUES ('AD_PRES', 'President', 20080, 40000);

-- 例えばEMPLOYEESテーブル
INSERT INTO HR.EMPLOYEES VALUES (100, 'Steven', 'King', 'SKING', '515.123.4567', TO_DATE('17/06/2003', 'DD/MM/YYYY'), 'AD_PRES', 24000, NULL, NULL, 90);

-- 他のテーブルに関しても、同様にINSERT文を実行してください。

-- インデックスの作成
CREATE UNIQUE INDEX REG_ID_PK ON HR.REGIONS (REGION_ID);
CREATE UNIQUE INDEX LOC_ID_PK ON HR.LOCATIONS (LOCATION_ID);
CREATE UNIQUE INDEX DEPT_ID_PK ON HR.DEPARTMENTS (DEPARTMENT_ID);
CREATE UNIQUE INDEX JOB_ID_PK ON HR.JOBS (JOB_ID);
CREATE UNIQUE INDEX JHIST_EMP_ID_ST_DATE_PK ON HR.JOB_HISTORY (EMPLOYEE_ID, START_DATE);

-- テーブル制約の追加（スキーマ作成時に行うことも可能）
ALTER TABLE HR.REGIONS ADD CONSTRAINT REGION_ID_NN CHECK (REGION_ID IS NOT NULL);
ALTER TABLE HR.COUNTRIES ADD CONSTRAINT country_id_nn CHECK (COUNTRY_ID IS NOT NULL);
ALTER TABLE HR.LOCATIONS ADD CONSTRAINT LOC_CITY_NN CHECK (CITY IS NOT NULL);
ALTER TABLE HR.DEPARTMENTS ADD CONSTRAINT DEPARTMENT_NAME_NN CHECK (DEPARTMENT_NAME IS NOT NULL);
ALTER TABLE HR.EMPLOYEES ADD (
    CONSTRAINT EMP_LAST_NAME_NN CHECK (LAST_NAME IS NOT NULL),
    CONSTRAINT EMP_EMAIL_NN CHECK (EMAIL IS NOT NULL),
    CONSTRAINT EMP_HIRE_DATE_NN CHECK (HIRE_DATE IS NOT NULL),
    CONSTRAINT EMP_JOB_NN CHECK (JOB_ID IS NOT NULL),
    CONSTRAINT EMP_SALARY_MIN CHECK (SALARY > 0)
);
